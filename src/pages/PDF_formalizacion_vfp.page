<apex:page renderAs="pdf" language="es" applyBodyTag="false" standardController="Opportunity" extensions="PDF_formalizacion_ctrl">
    <apex:stylesheet value="{!$Resource.stylePDF}"/>
    <apex:image value="{!URLFOR($Resource.BBVALogo)}" width="350" height="100"/>
    <div class="title">
       <b>&nbsp;PDF Formalización {!Opportunity.Name}</b>
    </div>
    <br/>
    <div class="subtitle">
        <b>&nbsp;Datos cliente</b>
    </div>
    <br/>
    <table>
        <tr>
            <th>Cliente: {!Client.Name}</th>
            <th></th>
        </tr>
        <tr>
            <td>Código central: {!Client.main_code_id__c} </td>
            <td>Nombre ejecutivo: {!Opportunity.Owner.Name} </td>
        </tr>
        <tr>
            <td>RUC: {!Client.AccountNumber} </td>
            <td>Registro ejecutivo: {!Opportunity.Owner.user_id__c} </td>
        </tr>
        <tr>
            <td>Oficina: {!Oficina.Name}</td>
            <td>Cod cartera: {!Opportunity.Owner.portfolio_classification_id__c}</td>
        </tr>
    </table>
    <br/>
    <div class="subtitle">
        <b>&nbsp;Datos riesgo</b>
    </div>
    <br/>
    <table>
        <tr>
            <td>Clasificación BBVA: {!Client.bbva_classification_desc__c} </td>
            <td>
                <apex:outputPanel rendered="{!IF(Client.alert_desc__c,true,false)}">
                    Alerta: Sí
                </apex:outputPanel>
                <apex:outputPanel rendered="{!IF(Client.alert_desc__c == false,true,false)}">
                    Alerta: No
                </apex:outputPanel>
            </td>
        </tr>
        <tr>
            <td>Clasificación SBS: {!Client.banking_system_classification_desc__c } </td>
            <td>Estrategia: {!Client.risk_strategy_class_name__c } </td>
        </tr>
        <tr>
            <td>Buró: <apex:outputText value="{0, number,0}">
                <apex:param value="{!Client.bureau_classification_type__c}"/>
                </apex:outputText></td>
            <td>Rating: {!Rating.rating_scale_type__c} </td>
        </tr>
    </table>
    <br/>
    <div class="subtitle">
        <b>&nbsp;Sanción riesgo</b>
    </div>
    <br/>
    <table>
        <tr>
            <td>Modalidad: {!Modalidad}</td>
            <td></td>
        </tr>
        <tr>
            <td>Codigo SIO: {!opportunity.sio_code__c} </td>
            <td>Fecha autorización: 12/07/2018 *</td>
        </tr>
        <tr>
            <td>Estado: Sanción aprobado SM *</td>
            <td>Sancionador: Andres figueroa *</td>
        </tr>
        <tr>
            <td>Importe: {!Opportunity.Amount}</td>
            <td>Compromisos: {!totalC}</td>
        </tr>
        <tr>
            <td>Plazo: <apex:outputText value=" {0, number,0} ">
                <apex:param value="{!Oli.gipr_Plazo__c}"/>
                </apex:outputText> {!Oli.gipr_Periodicidad__c }</td>
            <td>Comentarios: Aprobada</td>
        </tr>
    </table>
    <br/>
    <div class="subtitle">
        <b>&nbsp;Sanción precio</b>
    </div>
    <br/>
    <!--apex:outputPanel id="SanctionPrice1" rendered="{!Product.ProductCode !=$Label.lblPDFProductFurnitureLeasing && Product.ProductCode !=$Label.lblPDFProductCommercialLoanLP}" layout="block"-->
    <table>
        <tr>
            <td>Nº cotización: {!Oli.price_quote_id__c} </td>
            <td>Fecha autorización: 16/06/2018:9:00 </td>
        </tr>
        <tr>
            <td>TEA aprobada:<apex:outputText value=" {0, number,0.00} %">
                <apex:param value="{!Oli.proposed_apr_per__c}"/>
                </apex:outputText> </td>
            <td>Vigencia: 12/07/2018 </td>
        </tr>
        <tr>
            <td>Plazo: <apex:outputText value=" {0, number,0} ">
                <apex:param value="{!Oli.gipr_Plazo__c}"/>
                </apex:outputText> {!Oli.gipr_Periodicidad__c }</td>
            <td>Tipo garantía: {!Oli.gipr_Tipo_Garantia__c}</td>
        </tr>
        <apex:outputPanel rendered="{!Product.ProductCode == $Label.lblPDFProductExport}">
        <tr>
            <td>Medio de pago: {!OLI.gipr_Payment_Method__c}</td>
            <td>Bolsa comex: {!OLI.gipr_Comex_Bag__c}</td>
        </tr>
        </apex:outputPanel>
      <apex:outputPanel rendered="{!Product.ProductCode == $Label.lblPDFProductImport}">
        <tr>
            <td>Medio de pago: {!OLI.gipr_Payment_Method__c}</td>
            <td>Bolsa comex: {!OLI.gipr_Comex_Bag__c}</td>
        </tr>
        </apex:outputPanel>
        <tr>
            <td>Compromisos: {!totalC} </td>
            <td>Comentarios: Aprobada </td>
        </tr>
    </table>
    <apex:outputPanel id="DatosOportunidad"  layout="block">
        <br/>
        <div class="subtitle">
            <b>&nbsp;Datos de oportunidad</b>
        </div>
        <br/>
        <ul>
            <li>Nombre de la oportunidad: {!Opportunity.Name}</li>
            <li>Divisa: {!Opportunity.CurrencyIsoCode}</li>
            <li>Importe: <apex:outputText value=" {0, number,.00}">
                <apex:param value="{!Opportunity.Amount}" />
                </apex:outputText>
            </li>
            <li>Familia producto: {!Product.Family}</li>
            <li>Producto: {!Product.Name}</li>
            <li>Modalidad producto: {!Oli.PE_List_Product_mode__c}</li>
            <li>Destino: {!OLI.gipr_Destino__c}</li>
            <li>Mejorado: {!If(Oli.PE_List_Mejorado__c,'Si','No')}</li>
          </ul>
    </apex:outputPanel>
    <apex:outputPanel id="pagoliquidación"  layout="block">
        <br/>
        <div class="subtitle">
            <b>&nbsp;Criterios de pago y liquidacíon</b>
        </div>
        <br/>
        <ul>
            <li>Cuenta vinculada: {!OLI.cpliq_Cuenta_vinculada__c}</li>
            <li>Tipo de amortización: {!OLI.cpliq_Tipo_amortizacion__c} </li>
            <li>Fecha de vencimiento: <apex:outputText value="{0,date,dd/MM/yyyy}">
                <apex:param value="{!Oli.cpliq_Fecha_Vencimiento__c}" />
                </apex:outputText></li>
            <li>Plazo: <apex:outputText value=" {0, number,0} ">
                <apex:param value="{!Oli.gipr_Plazo__c}" />
                </apex:outputText> {!Oli.gipr_Periodicidad__c }</li>
            <li>Periodo de gracia: <apex:outputText value="{0, number,0}">
                <apex:param value="{!Oli.cpliq_n_gracia__c }" />
                </apex:outputText> {!Oli.cpliq_Periodicidad_gracia__c}</li>
          </ul>
    </apex:outputPanel>
    <div class="subtitle">
            <b>&nbsp;Garantias e intervinientes</b>
    </div>
    <br/>
    <div class="subtitle">
        &nbsp;Garantias
    </div>
    <table class="classTableBack">
        <tr>
            <th class="cb">Garantía</th>
            <th class="cb">Modalidad</th>
            <th class="cb">Estado</th>
            <th class="cb">Plazo Formalización</th>
            <th class="cb">Nº.garantía</th>
            <th class="cb">Importe</th>
        </tr>
        <apex:repeat value="{!Garantias}" var="Garantia" id="Garantias">
            <tr>
                <td class="cd">{!Garantia.Guarantee__c}</td>
                <td class="cd">{!Garantia.Modality__c}</td>
                <td class="cd">{!Garantia.Status__c}</td>
                <td class="cd"><apex:outputText value="{0, number,0}">
                    <apex:param value="{!Garantia.Term__c}"/>
                    </apex:outputText> {!Garantia.Periodicity__c}</td>
                <td class="cd"><apex:outputText value="{0, number,0}">
                    <apex:param value="{!Garantia.nGuarantee__c}" />
                    </apex:outputText></td>
                <td class="cd"><apex:outputText value="{0,number,.00}">
                    <apex:param value="{!Garantia.Amount__c}" />
                    </apex:outputText>
                </td>
            </tr>
        </apex:repeat>
    </table>
    <br/>
    <div class="subtitle">
        &nbsp;Intervinientes
    </div>
    <table class="classTableBack">
        <tr>
            <th class="cb">Nombre/Cliente</th>
            <th class="cb">DOI</th>
            <th class="cb">Nº DOI</th>
            <th class="cb">Participación</th>
            <th class="cb">Estado cívil</th>
        </tr>
        <apex:repeat value="{!Intervenientes}" var="Interveniente" id="Intervenientes">
            <tr>
                <td class="cd">{!Interveniente.Name}</td>
                <td class="cd">{!Interveniente.DOI__c}</td>
                <td class="cd">{!Interveniente.N_DOI__c}</td>
                <td class="cd">{!Interveniente.Participation__c}</td>
                <td class="cd">{!Interveniente.Marital_Status__c}</td>
            </tr>
        </apex:repeat>
    </table>
    <div class="footer">
        <div>Página <span class="pagenumber"/> de <span class="pagecount"/></div>
    </div>
</apex:page>
