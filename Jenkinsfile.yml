---
domain: salesforce.app
stages:
    staticAnalysis:
        skip: false
        params:
            skipEslint: true
            skipLintSpaces: true
            skipStyleLint: true
            skipPmdApex: true
            skipSonar: false
            sonar:
                exclusions: src/pages/Minuta.page
    unitTesting:
        skip: true
    deploy:
        skip: true
    functionalTesting:
        skip: true
    structuralTesting:
        skip: true
    publish:
        params:
            mdapiConfig:
                command: deploy
                apiVersion: 48.0
branches:
    feature:
        stages:
            deploy:
                skip: false
                params:
                    mdapiConfig:
                        credentialId: SFDC_DEV
                        command: testDeploy
                        testLevel: RunLocalTests
                        
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_QA_DWP
                        command: testDeploy
                        testLevel: RunLocalTests
    feature/dwp-qa:
        stages:
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_QA_DWP
                        testLevel: RunLocalTests
                                         
    develop:
        stages:
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_DEV
                        testLevel: RunLocalTests
    release:
        stages:
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_UAT
                        testLevel: RunLocalTests

    preprod:
        stages:
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_PREPROD
                        testLevel: RunLocalTests

    hotfix:
        stages:
            deploy: 
                skip: false
                params:
                    mdapiConfig:
                        credentialId: SFDC_PREPROD
                        testLevel: RunLocalTests
                        
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_PROD
                        command: testDeploy
                        testLevel: RunLocalTests
                        serverUrl: login.salesforce.com

    bugfix:
        stages:
           # deploy: 
           #     skip: false
           #     params:
           #        mdapiConfig:
           #            credentialId: SFDC_BUGFIX
           #            testLevel: RunLocalTests
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_UAT
                        testLevel: RunLocalTests
                        command: testDeploy

    master:
        stages:
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_PROD
                        testLevel: RunLocalTests
pullRequests:
    release:
        stages:
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_UAT
                        command: testDeploy
                        testLevel: RunLocalTests
    master:
        stages:
            publish:
                params:
                    mdapiConfig:
                        credentialId: SFDC_PROD
                        command: testDeploy
                        testLevel: RunLocalTests
                        serverUrl: login.salesforce.com